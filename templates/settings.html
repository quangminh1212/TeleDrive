{% extends "base.html" %}

{% block title %}Settings - TeleDrive{% endblock %}

{% block content %}
<div class="content-header">
    <div class="content-title">
        <h1>Settings</h1>
        <p class="content-subtitle">Configure your TeleDrive application</p>
    </div>
</div>

<div class="settings-container">
    <!-- Telegram Configuration -->
    <div class="settings-section">
        <div class="section-header">
            <div class="section-icon">
                <i class="fab fa-telegram"></i>
            </div>
            <div class="section-info">
                <h2>Telegram Configuration</h2>
                <p>Configure your Telegram API credentials to access channels</p>
            </div>
        </div>
        
        <div class="settings-card">
            <form class="settings-form" id="telegramForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="apiId">API ID</label>
                        <input type="text" id="apiId" name="api_id" placeholder="Your Telegram API ID">
                        <div class="form-help">
                            Get your API ID from <a href="https://my.telegram.org/apps" target="_blank">my.telegram.org/apps</a>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="apiHash">API Hash</label>
                        <input type="text" id="apiHash" name="api_hash" placeholder="Your Telegram API Hash">
                        <div class="form-help">
                            Get your API Hash from <a href="https://my.telegram.org/apps" target="_blank">my.telegram.org/apps</a>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="phoneNumber">Phone Number</label>
                    <input type="tel" id="phoneNumber" name="phone_number" placeholder="+1234567890">
                    <div class="form-help">
                        Enter your phone number with country code (e.g., +1234567890)
                    </div>
                </div>
                
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i>
                        Save Telegram Settings
                    </button>
                    <button type="button" class="btn btn-secondary" id="testTelegramBtn">
                        <i class="fas fa-plug"></i>
                        Test Connection
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Scanning Preferences -->
    <div class="settings-section">
        <div class="section-header">
            <div class="section-icon">
                <i class="fas fa-search"></i>
            </div>
            <div class="section-info">
                <h2>Scanning Preferences</h2>
                <p>Configure default scanning behavior and file type preferences</p>
            </div>
        </div>
        
        <div class="settings-card">
            <form class="settings-form" id="scanningForm">
                <div class="form-group">
                    <label>Default File Types to Scan</label>
                    <div class="checkbox-grid">
                        <label class="checkbox-item">
                            <input type="checkbox" name="scan_documents" checked>
                            <span class="checkmark"></span>
                            <i class="fas fa-file-alt"></i>
                            Documents
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" name="scan_photos" checked>
                            <span class="checkmark"></span>
                            <i class="fas fa-image"></i>
                            Photos
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" name="scan_videos" checked>
                            <span class="checkmark"></span>
                            <i class="fas fa-video"></i>
                            Videos
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" name="scan_audio" checked>
                            <span class="checkmark"></span>
                            <i class="fas fa-music"></i>
                            Audio
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" name="scan_voice">
                            <span class="checkmark"></span>
                            <i class="fas fa-microphone"></i>
                            Voice Messages
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" name="scan_stickers">
                            <span class="checkmark"></span>
                            <i class="fas fa-smile"></i>
                            Stickers
                        </label>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="defaultMaxMessages">Default Max Messages</label>
                        <select id="defaultMaxMessages" name="default_max_messages">
                            <option value="">All messages (unlimited)</option>
                            <option value="100">Last 100 messages</option>
                            <option value="500">Last 500 messages</option>
                            <option value="1000" selected>Last 1,000 messages</option>
                            <option value="5000">Last 5,000 messages</option>
                            <option value="10000">Last 10,000 messages</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="batchSize">Batch Size</label>
                        <select id="batchSize" name="batch_size">
                            <option value="50">50 messages</option>
                            <option value="100" selected>100 messages</option>
                            <option value="200">200 messages</option>
                            <option value="500">500 messages</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i>
                        Save Scanning Preferences
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Storage & Output -->
    <div class="settings-section">
        <div class="section-header">
            <div class="section-icon">
                <i class="fas fa-hdd"></i>
            </div>
            <div class="section-info">
                <h2>Storage & Output</h2>
                <p>Configure file storage and output format preferences</p>
            </div>
        </div>
        
        <div class="settings-card">
            <form class="settings-form" id="storageForm">
                <div class="form-group">
                    <label for="outputDirectory">Output Directory</label>
                    <div class="input-group">
                        <input type="text" id="outputDirectory" name="output_directory" value="output" readonly>
                        <button type="button" class="input-btn" id="browseOutputBtn">
                            <i class="fas fa-folder-open"></i>
                        </button>
                    </div>
                    <div class="form-help">
                        Directory where scan results will be saved
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Output Formats</label>
                    <div class="checkbox-grid">
                        <label class="checkbox-item">
                            <input type="checkbox" name="output_json" checked>
                            <span class="checkmark"></span>
                            <i class="fas fa-code"></i>
                            JSON
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" name="output_csv" checked>
                            <span class="checkmark"></span>
                            <i class="fas fa-table"></i>
                            CSV
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" name="output_excel" checked>
                            <span class="checkmark"></span>
                            <i class="fas fa-file-excel"></i>
                            Excel
                        </label>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="maxFileSize">Max File Size (MB)</label>
                        <input type="number" id="maxFileSize" name="max_file_size" value="500" min="1" max="2000">
                    </div>
                    <div class="form-group">
                        <label for="autoCleanup">Auto Cleanup (days)</label>
                        <input type="number" id="autoCleanup" name="auto_cleanup_days" value="30" min="1" max="365">
                        <div class="form-help">
                            Automatically delete old scan results after specified days
                        </div>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i>
                        Save Storage Settings
                    </button>
                    <button type="button" class="btn btn-secondary" id="cleanupNowBtn">
                        <i class="fas fa-broom"></i>
                        Cleanup Now
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Application Settings -->
    <div class="settings-section">
        <div class="section-header">
            <div class="section-icon">
                <i class="fas fa-cog"></i>
            </div>
            <div class="section-info">
                <h2>Application Settings</h2>
                <p>General application preferences and behavior</p>
            </div>
        </div>
        
        <div class="settings-card">
            <form class="settings-form" id="appForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="theme">Theme</label>
                        <select id="theme" name="theme">
                            <option value="light" selected>Light</option>
                            <option value="dark">Dark</option>
                            <option value="auto">Auto (System)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="language">Language</label>
                        <select id="language" name="language">
                            <option value="en" selected>English</option>
                            <option value="vi">Tiếng Việt</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="checkbox-item">
                        <input type="checkbox" name="enable_notifications" checked>
                        <span class="checkmark"></span>
                        Enable desktop notifications
                    </label>
                </div>
                
                <div class="form-group">
                    <label class="checkbox-item">
                        <input type="checkbox" name="auto_refresh" checked>
                        <span class="checkmark"></span>
                        Auto-refresh file list
                    </label>
                </div>
                
                <div class="form-group">
                    <label class="checkbox-item">
                        <input type="checkbox" name="detailed_logging">
                        <span class="checkmark"></span>
                        Enable detailed logging
                    </label>
                </div>
                
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i>
                        Save App Settings
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Danger Zone -->
    <div class="settings-section danger-zone">
        <div class="section-header">
            <div class="section-icon">
                <i class="fas fa-exclamation-triangle"></i>
            </div>
            <div class="section-info">
                <h2>Danger Zone</h2>
                <p>Irreversible and destructive actions</p>
            </div>
        </div>
        
        <div class="settings-card">
            <div class="danger-actions">
                <div class="danger-item">
                    <div class="danger-info">
                        <h3>Clear All Scan Data</h3>
                        <p>Remove all scanned files and results from the database</p>
                    </div>
                    <button type="button" class="btn btn-danger" id="clearDataBtn">
                        <i class="fas fa-trash"></i>
                        Clear Data
                    </button>
                </div>
                
                <div class="danger-item">
                    <div class="danger-info">
                        <h3>Reset Configuration</h3>
                        <p>Reset all settings to default values</p>
                    </div>
                    <button type="button" class="btn btn-danger" id="resetConfigBtn">
                        <i class="fas fa-undo"></i>
                        Reset Config
                    </button>
                </div>
                
                <div class="danger-item">
                    <div class="danger-info">
                        <h3>Delete Telegram Session</h3>
                        <p>Remove saved Telegram session (you'll need to re-authenticate)</p>
                    </div>
                    <button type="button" class="btn btn-danger" id="deleteSessionBtn">
                        <i class="fas fa-sign-out-alt"></i>
                        Delete Session
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Success Message -->
<div class="success-banner" id="successBanner" style="display: none;">
    <div class="success-content">
        <i class="fas fa-check-circle"></i>
        <span>Settings saved successfully!</span>
        <button class="success-close" onclick="this.parentElement.parentElement.style.display='none'">
            <i class="fas fa-times"></i>
        </button>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/settings.css') }}">
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/settings.js') }}"></script>
{% endblock %}
