<<<<<<< HEAD
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TeleDrive File Manager</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="header-left">
                <div class="logo">
                    <img src="{{ url_for('static', filename='images/logo.png') }}" alt="TeleDrive Logo" class="logo-image">
                    <span>TeleDrive</span>
                </div>
                <div class="header-title">File Manager</div>
            </div>
            
            <div class="header-center">
                <div class="search-container">
                    <i class="fas fa-search"></i>
                    <input type="text" id="globalSearch" placeholder="Tìm kiếm file...">
                    <button id="clearSearch" class="clear-btn" style="display: none;">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            
            <div class="header-right">
                <div class="stats-summary" id="globalStats">
                    <div class="stat-item">
                        <span class="stat-value">0</span>
                        <span class="stat-label">Files</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value">0 B</span>
                        <span class="stat-label">Total</span>
                    </div>
                </div>

                <!-- User Menu -->
                <div class="user-menu">
                    <div class="user-info">
                        <i class="fas fa-user-circle"></i>
                        <span class="username">{{ user.username }}</span>
                        {% if user.is_admin %}
                            <span class="admin-badge">Admin</span>
                        {% endif %}
                    </div>
                    <div class="user-dropdown">
                        <button class="dropdown-toggle" id="userMenuToggle">
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="dropdown-menu" id="userDropdown">
                            <div class="dropdown-item user-details">
                                <div class="user-name">{{ user.username }}</div>
                                <div class="user-email">{{ user.email }}</div>
                            </div>
                            <div class="dropdown-divider"></div>
                            <button class="dropdown-item" id="logoutBtn">
                                <i class="fas fa-sign-out-alt"></i>
                                Đăng xuất
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h3>Scan Sessions</h3>
                <button class="sidebar-toggle" id="sidebarToggle">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
            
            <div class="sessions-list" id="sessionsList">
                <div class="loading">
                    <i class="fas fa-spinner fa-spin"></i>
                    <span>Đang tải...</span>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Toolbar -->
            <div class="toolbar">
                <div class="toolbar-left">
                    <div class="view-options">
                        <button class="view-btn active" data-view="grid">
                            <i class="fas fa-th"></i>
                        </button>
                        <button class="view-btn" data-view="list">
                            <i class="fas fa-list"></i>
                        </button>
                    </div>
                    
                    <div class="filter-options">
                        <select id="fileTypeFilter">
                            <option value="all">Tất cả file</option>
                            <option value="document">Documents</option>
                            <option value="photo">Photos</option>
                            <option value="video">Videos</option>
                            <option value="audio">Audio</option>
                            <option value="voice">Voice</option>
                            <option value="sticker">Stickers</option>
                            <option value="animation">Animations</option>
                        </select>
                    </div>
                </div>
                
                <div class="toolbar-right">
                    <div class="sort-options">
                        <select id="sortBy">
                            <option value="name">Tên file</option>
                            <option value="size">Kích thước</option>
                            <option value="date">Ngày upload</option>
                            <option value="type">Loại file</option>
                        </select>
                        <button id="sortOrder" class="sort-btn" data-order="asc">
                            <i class="fas fa-sort-alpha-down"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Content Area -->
            <div class="content-area">
                <!-- Welcome Screen -->
                <div class="welcome-screen" id="welcomeScreen">
                    <div class="welcome-content">
                        <i class="fab fa-telegram-plane welcome-icon"></i>
                        <h2>Chào mừng đến với TeleDrive</h2>
                        <p>Chọn một scan session từ sidebar để xem các file đã quét được</p>
                    </div>
                </div>

                <!-- Files Grid -->
                <div class="files-container" id="filesContainer" style="display: none;">
                    <div class="session-info" id="sessionInfo">
                        <h2 id="sessionTitle">Session</h2>
                        <div class="session-stats" id="sessionStats"></div>
                    </div>
                    
                    <div class="files-grid" id="filesGrid">
                        <!-- Files will be loaded here -->
                    </div>
                    
                    <!-- Pagination -->
                    <div class="pagination" id="pagination" style="display: none;">
                        <button id="prevPage" class="page-btn">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <span id="pageInfo">Trang 1 / 1</span>
                        <button id="nextPage" class="page-btn">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>

                <!-- Loading -->
                <div class="loading-screen" id="loadingScreen" style="display: none;">
                    <div class="loading">
                        <i class="fas fa-spinner fa-spin"></i>
                        <span>Đang tải file...</span>
                    </div>
                </div>

                <!-- No Results -->
                <div class="no-results" id="noResults" style="display: none;">
                    <i class="fas fa-search"></i>
                    <h3>Không tìm thấy file nào</h3>
                    <p>Thử thay đổi từ khóa tìm kiếm hoặc bộ lọc</p>
                </div>
            </div>
        </main>
    </div>

    <!-- File Detail Modal -->
    <div class="modal" id="fileModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Chi tiết file</h3>
                <button class="modal-close" id="modalClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body" id="modalBody">
                <!-- File details will be loaded here -->
            </div>
            
            <div class="modal-footer">
                <button class="btn btn-secondary" id="modalCloseBtn">Đóng</button>
                <button class="btn btn-primary" id="downloadBtn">
                    <i class="fas fa-download"></i>
                    Tải xuống
                </button>
            </div>
        </div>
    </div>

    <!-- Mobile Menu Overlay -->
    <div class="mobile-overlay" id="mobileOverlay"></div>

    <!-- Scripts -->
    <script src="/static/js/app.js"></script>
</body>
</html>
=======
{% extends "base.html" %}

{% block title %}My Drive - TeleDrive{% endblock %}

{% block content %}
<div class="content-header">
    <div class="content-title">
        <h1>My Drive</h1>
    </div>
    
    <div class="content-actions">
        <div class="view-options">
            <button class="view-btn active" id="gridView" title="Grid view">
                <i class="fas fa-th"></i>
            </button>
            <button class="view-btn" id="listView" title="List view">
                <i class="fas fa-list"></i>
            </button>
        </div>
        
        <div class="sort-options">
            <select class="sort-select" id="sortSelect">
                <option value="name">Name</option>
                <option value="modified">Last modified</option>
                <option value="size">File size</option>
                <option value="type">Type</option>
            </select>
        </div>
        
        <button class="filter-btn" id="filterBtn" title="Filter">
            <i class="fas fa-filter"></i>
        </button>
    </div>
</div>

<!-- Quick Access -->
<div class="quick-access">
    <h2 class="section-title">Quick access</h2>
    <div class="quick-items">
        <div class="quick-item">
            <div class="quick-icon">
                <i class="fas fa-star"></i>
            </div>
            <span>Starred</span>
        </div>
        <div class="quick-item">
            <div class="quick-icon">
                <i class="fas fa-clock"></i>
            </div>
            <span>Recent</span>
        </div>
        <div class="quick-item">
            <div class="quick-icon">
                <i class="fab fa-telegram"></i>
            </div>
            <span>Telegram Files</span>
        </div>
        <div class="quick-item">
            <div class="quick-icon">
                <i class="fas fa-image"></i>
            </div>
            <span>Images</span>
        </div>
    </div>
</div>

<!-- Files Section -->
<div class="files-section">
    <div class="section-header">
        <h2 class="section-title">Files</h2>
        <div class="section-info">
            <span class="file-count">{{ total_files }} items</span>
        </div>
    </div>
    
    <!-- Files Grid/List Container -->
    <div class="files-container" id="filesContainer">
        {% if files %}
            <div class="files-grid" id="filesGrid">
                {% for file in files %}
                <div class="file-item" data-file-id="{{ file.id }}" data-file-type="{{ file.type }}">
                    <div class="file-preview">
                        {% if file.type == 'photo' %}
                            <div class="file-thumbnail image-thumbnail">
                                <i class="{{ file.icon }}"></i>
                            </div>
                        {% else %}
                            <div class="file-thumbnail">
                                <i class="{{ file.icon }}"></i>
                            </div>
                        {% endif %}
                        
                        <div class="file-actions">
                            <button class="file-action-btn" title="Download">
                                <i class="fas fa-download"></i>
                            </button>
                            <button class="file-action-btn" title="Share">
                                <i class="fas fa-share"></i>
                            </button>
                            <button class="file-action-btn" title="More">
                                <i class="fas fa-ellipsis-v"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="file-info">
                        <div class="file-name" title="{{ file.name }}">{{ file.name }}</div>
                        <div class="file-meta">
                            <span class="file-size">{{ file.formatted_size }}</span>
                            {% if file.source == 'telegram' %}
                                <span class="file-source">
                                    <i class="fab fa-telegram"></i>
                                </span>
                            {% endif %}
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="empty-state">
                <div class="empty-icon">
                    <i class="fas fa-folder-open"></i>
                </div>
                <h3>No files yet</h3>
                <p>Upload files or scan Telegram channels to get started</p>
                <div class="empty-actions">
                    <button class="btn btn-primary" id="emptyUploadBtn">
                        <i class="fas fa-upload"></i>
                        Upload files
                    </button>
                    <button class="btn btn-secondary" id="emptyScanBtn">
                        <i class="fab fa-telegram"></i>
                        Scan Telegram
                    </button>
                </div>
            </div>
        {% endif %}
    </div>
</div>

<!-- File Context Menu -->
<div class="context-menu" id="fileContextMenu">
    <div class="context-item" id="openFile">
        <i class="fas fa-eye"></i>
        <span>Open</span>
    </div>
    <div class="context-item" id="downloadFile">
        <i class="fas fa-download"></i>
        <span>Download</span>
    </div>
    <div class="context-item" id="shareFile">
        <i class="fas fa-share"></i>
        <span>Share</span>
    </div>
    <hr class="context-divider">
    <div class="context-item" id="renameFile">
        <i class="fas fa-edit"></i>
        <span>Rename</span>
    </div>
    <div class="context-item" id="moveFile">
        <i class="fas fa-arrows-alt"></i>
        <span>Move</span>
    </div>
    <hr class="context-divider">
    <div class="context-item" id="starFile">
        <i class="fas fa-star"></i>
        <span>Add to starred</span>
    </div>
    <div class="context-item danger" id="deleteFile">
        <i class="fas fa-trash"></i>
        <span>Move to trash</span>
    </div>
</div>

<!-- File Preview Modal -->
<div class="modal large" id="previewModal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="previewTitle">File Preview</h3>
            <div class="modal-actions">
                <button class="modal-btn" id="downloadPreview" title="Download">
                    <i class="fas fa-download"></i>
                </button>
                <button class="modal-btn" id="sharePreview" title="Share">
                    <i class="fas fa-share"></i>
                </button>
                <button class="modal-close" id="closePreviewModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        <div class="modal-body">
            <div class="preview-container" id="previewContainer">
                <!-- Preview content will be loaded here -->
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// Initialize file grid functionality
document.addEventListener('DOMContentLoaded', function() {
    initializeFileGrid();
    initializeViewToggle();
    initializeSorting();
    initializeContextMenu();
    initializeFilePreview();
});

function initializeFileGrid() {
    const fileItems = document.querySelectorAll('.file-item');
    
    fileItems.forEach(item => {
        // Double click to open/preview
        item.addEventListener('dblclick', function() {
            const fileId = this.dataset.fileId;
            const fileType = this.dataset.fileType;
            openFilePreview(fileId, fileType);
        });
        
        // Right click for context menu
        item.addEventListener('contextmenu', function(e) {
            e.preventDefault();
            showContextMenu(e, this);
        });
        
        // Selection handling
        item.addEventListener('click', function(e) {
            if (!e.ctrlKey && !e.metaKey) {
                // Clear other selections
                document.querySelectorAll('.file-item.selected').forEach(selected => {
                    selected.classList.remove('selected');
                });
            }
            this.classList.toggle('selected');
        });
    });
}

function initializeViewToggle() {
    const gridViewBtn = document.getElementById('gridView');
    const listViewBtn = document.getElementById('listView');
    const filesGrid = document.getElementById('filesGrid');
    
    gridViewBtn.addEventListener('click', function() {
        filesGrid.className = 'files-grid';
        gridViewBtn.classList.add('active');
        listViewBtn.classList.remove('active');
    });
    
    listViewBtn.addEventListener('click', function() {
        filesGrid.className = 'files-list';
        gridViewBtn.classList.remove('active');
        listViewBtn.classList.add('active');
    });
}

function initializeSorting() {
    const sortSelect = document.getElementById('sortSelect');
    
    sortSelect.addEventListener('change', function() {
        const sortBy = this.value;
        sortFiles(sortBy);
    });
}

function sortFiles(sortBy) {
    const filesGrid = document.getElementById('filesGrid');
    const fileItems = Array.from(filesGrid.querySelectorAll('.file-item'));
    
    fileItems.sort((a, b) => {
        const aName = a.querySelector('.file-name').textContent;
        const bName = b.querySelector('.file-name').textContent;
        
        switch(sortBy) {
            case 'name':
                return aName.localeCompare(bName);
            case 'type':
                return a.dataset.fileType.localeCompare(b.dataset.fileType);
            default:
                return aName.localeCompare(bName);
        }
    });
    
    // Re-append sorted items
    fileItems.forEach(item => filesGrid.appendChild(item));
}

function initializeContextMenu() {
    const contextMenu = document.getElementById('fileContextMenu');
    
    // Hide context menu when clicking elsewhere
    document.addEventListener('click', function() {
        contextMenu.style.display = 'none';
    });
}

function showContextMenu(event, fileItem) {
    const contextMenu = document.getElementById('fileContextMenu');
    
    contextMenu.style.display = 'block';
    contextMenu.style.left = event.pageX + 'px';
    contextMenu.style.top = event.pageY + 'px';
    
    // Store reference to the file item
    contextMenu.dataset.fileId = fileItem.dataset.fileId;
}

function initializeFilePreview() {
    // Empty state buttons
    const emptyUploadBtn = document.getElementById('emptyUploadBtn');
    const emptyScanBtn = document.getElementById('emptyScanBtn');
    
    if (emptyUploadBtn) {
        emptyUploadBtn.addEventListener('click', function() {
            document.getElementById('newBtn').click();
        });
    }
    
    if (emptyScanBtn) {
        emptyScanBtn.addEventListener('click', function() {
            window.location.href = '{{ url_for("scan_page") }}';
        });
    }
}

function openFilePreview(fileId, fileType) {
    const modal = document.getElementById('previewModal');
    const previewContainer = document.getElementById('previewContainer');
    
    // Show loading
    previewContainer.innerHTML = '<div class="loading-spinner"><i class="fas fa-spinner fa-spin"></i><p>Loading preview...</p></div>';
    modal.style.display = 'flex';
    
    // Load preview content based on file type
    setTimeout(() => {
        previewContainer.innerHTML = `
            <div class="preview-placeholder">
                <i class="fas fa-file-alt fa-5x"></i>
                <p>Preview not available for this file type</p>
                <button class="btn btn-primary" onclick="downloadFile('${fileId}')">
                    <i class="fas fa-download"></i> Download File
                </button>
            </div>
        `;
    }, 500);
}

function downloadFile(fileId) {
    showToast('Download started', 'info');
    // Implement download functionality
}
</script>
{% endblock %}
>>>>>>> 7.addGGDriveUI
