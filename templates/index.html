<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TeleDrive File Manager</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Segoe+UI:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <!-- Windows Explorer Style Title Bar -->
    <div class="explorer-title-bar">
        <div class="title-bar-left">
            <div class="app-icon">
                <img src="{{ url_for('static', filename='images/logo.png') }}" alt="TeleDrive" class="app-icon-img">
            </div>
            <span class="window-title">TeleDrive - File Manager</span>
        </div>
        <div class="title-bar-right">
            <div class="user-info">
                <i class="icon icon-user"></i>
                <span class="username">{{ user.username }}</span>
                {% if user.is_admin %}
                    <span class="admin-badge">Admin</span>
                {% endif %}
            </div>
            <div class="window-controls">
                <button class="window-control minimize" title="Minimize">
                    <i class="icon icon-minus"></i>
                </button>
                <button class="window-control maximize" title="Maximize">
                    <i class="icon icon-square"></i>
                </button>
                <button class="window-control close" id="logoutBtn" title="Sign out">
                    <i class="icon icon-times"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Windows Explorer Style Ribbon Toolbar -->
    <div class="explorer-ribbon">
        <div class="ribbon-tabs">
            <button class="ribbon-tab active" data-tab="home">Home</button>
            <button class="ribbon-tab" data-tab="share">Share</button>
            <button class="ribbon-tab" data-tab="view">View</button>
        </div>

        <div class="ribbon-content">
            <!-- Home Tab -->
            <div class="ribbon-panel active" id="homePanel">
                <div class="ribbon-group">
                    <div class="ribbon-group-header">Clipboard</div>
                    <div class="ribbon-buttons">
                        <button class="ribbon-btn large" id="pasteBtn" title="Paste" disabled>
                            <i class="icon icon-paste"></i>
                            <span>Paste</span>
                        </button>
                        <div class="ribbon-btn-group">
                            <button class="ribbon-btn" id="cutBtn" title="Cut" disabled>
                                <i class="icon icon-cut"></i>
                                <span>Cut</span>
                            </button>
                            <button class="ribbon-btn" id="copyBtn" title="Copy" disabled>
                                <i class="icon icon-copy"></i>
                                <span>Copy</span>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="ribbon-group">
                    <div class="ribbon-group-header">Organize</div>
                    <div class="ribbon-buttons">
                        <button class="ribbon-btn large" id="moveBtn" title="Move to" disabled>
                            <i class="icon icon-move"></i>
                            <span>Move to</span>
                        </button>
                        <button class="ribbon-btn large" id="copyToBtn" title="Copy to" disabled>
                            <i class="icon icon-copy-to"></i>
                            <span>Copy to</span>
                        </button>
                        <button class="ribbon-btn large" id="deleteBtn" title="Delete" disabled>
                            <i class="icon icon-trash"></i>
                            <span>Delete</span>
                        </button>
                        <button class="ribbon-btn large" id="renameBtn" title="Rename" disabled>
                            <i class="icon icon-edit"></i>
                            <span>Rename</span>
                        </button>
                    </div>
                </div>

                <div class="ribbon-group">
                    <div class="ribbon-group-header">New</div>
                    <div class="ribbon-buttons">
                        <button class="ribbon-btn large" id="newFolderBtn" title="New folder">
                            <i class="icon icon-folder-plus"></i>
                            <span>New folder</span>
                        </button>
                    </div>
                </div>

                <div class="ribbon-group">
                    <div class="ribbon-group-header">Open</div>
                    <div class="ribbon-buttons">
                        <button class="ribbon-btn large" id="propertiesBtn" title="Properties" disabled>
                            <i class="icon icon-info"></i>
                            <span>Properties</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Share Tab -->
            <div class="ribbon-panel" id="sharePanel">
                <div class="ribbon-group">
                    <div class="ribbon-group-header">Send</div>
                    <div class="ribbon-buttons">
                        <button class="ribbon-btn large" id="shareBtn" title="Share" disabled>
                            <i class="icon icon-share"></i>
                            <span>Share</span>
                        </button>
                        <button class="ribbon-btn large" id="emailBtn" title="Email" disabled>
                            <i class="icon icon-email"></i>
                            <span>Email</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- View Tab -->
            <div class="ribbon-panel" id="viewPanel">
                <div class="ribbon-group">
                    <div class="ribbon-group-header">Layout</div>
                    <div class="ribbon-buttons">
                        <button class="ribbon-btn view-btn active" data-view="icons" title="Large icons">
                            <i class="icon icon-view-grid"></i>
                            <span>Large icons</span>
                        </button>
                        <button class="ribbon-btn view-btn" data-view="list" title="List">
                            <i class="icon icon-view-list"></i>
                            <span>List</span>
                        </button>
                        <button class="ribbon-btn view-btn" data-view="details" title="Details">
                            <i class="icon icon-view-details"></i>
                            <span>Details</span>
                        </button>
                    </div>
                </div>

                <div class="ribbon-group">
                    <div class="ribbon-group-header">Current view</div>
                    <div class="ribbon-buttons">
                        <button class="ribbon-btn" id="sortBtn" title="Sort by">
                            <i class="icon icon-sort"></i>
                            <span>Sort by</span>
                        </button>
                        <button class="ribbon-btn" id="groupBtn" title="Group by">
                            <i class="icon icon-group"></i>
                            <span>Group by</span>
                        </button>
                    </div>
                </div>

                <div class="ribbon-group">
                    <div class="ribbon-group-header">Show/hide</div>
                    <div class="ribbon-buttons">
                        <button class="ribbon-btn" id="detailsPaneBtn" title="Details pane">
                            <i class="icon icon-panel-right"></i>
                            <span>Details pane</span>
                        </button>
                        <button class="ribbon-btn" id="previewPaneBtn" title="Preview pane">
                            <i class="icon icon-preview"></i>
                            <span>Preview pane</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Windows Explorer Style Navigation Pane -->
        <aside class="navigation-pane" id="navigationPane">
            <!-- Quick Access Section -->
            <div class="nav-section">
                <div class="nav-section-header">
                    <button class="section-toggle expanded" data-section="quick-access">
                        <i class="icon icon-chevron-down"></i>
                    </button>
                    <span class="section-title">Quick access</span>
                </div>
                <div class="nav-section-content" id="quickAccessContent">
                    <div class="nav-item" data-path="Desktop">
                        <i class="icon icon-desktop"></i>
                        <span>Desktop</span>
                    </div>
                    <div class="nav-item" data-path="Downloads">
                        <i class="icon icon-download"></i>
                        <span>Downloads</span>
                    </div>
                    <div class="nav-item" data-path="Documents">
                        <i class="icon icon-file-text"></i>
                        <span>Documents</span>
                    </div>
                    <div class="nav-item" data-path="Pictures">
                        <i class="icon icon-image"></i>
                        <span>Pictures</span>
                    </div>
                </div>
            </div>

            <!-- This PC Section -->
            <div class="nav-section">
                <div class="nav-section-header">
                    <button class="section-toggle expanded" data-section="this-pc">
                        <i class="icon icon-chevron-down"></i>
                    </button>
                    <span class="section-title">This PC</span>
                </div>
                <div class="nav-section-content" id="thisPcContent">
                    <div class="nav-item" data-path="C:">
                        <i class="icon icon-drive"></i>
                        <span>Local Disk (C:)</span>
                    </div>
                    <div class="nav-item" data-path="D:">
                        <i class="icon icon-drive"></i>
                        <span>Data (D:)</span>
                    </div>
                </div>
            </div>

            <!-- TeleDrive Sessions Section -->
            <div class="nav-section">
                <div class="nav-section-header">
                    <button class="section-toggle expanded" data-section="teledrive">
                        <i class="icon icon-chevron-down"></i>
                    </button>
                    <span class="section-title">TeleDrive Sessions</span>
                </div>
                <div class="nav-section-content" id="sessionsList">
                    <div class="loading">
                        <i class="icon icon-spinner"></i>
                        <span>Loading...</span>
                    </div>
                </div>
            </div>

            <!-- Network Section -->
            <div class="nav-section">
                <div class="nav-section-header">
                    <button class="section-toggle collapsed" data-section="network">
                        <i class="icon icon-chevron-right"></i>
                    </button>
                    <span class="section-title">Network</span>
                </div>
                <div class="nav-section-content" id="networkContent" style="display: none;">
                    <div class="nav-item" data-path="Network">
                        <i class="icon icon-network"></i>
                        <span>Network locations</span>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Windows Explorer Style Navigation Bar -->
            <div class="explorer-navigation-bar">
                <!-- Navigation Controls -->
                <div class="nav-controls">
                    <button id="backBtn" class="nav-btn" title="Back" disabled>
                        <i class="icon icon-arrow-left"></i>
                    </button>
                    <button id="forwardBtn" class="nav-btn" title="Forward" disabled>
                        <i class="icon icon-arrow-right"></i>
                    </button>
                    <button id="upBtn" class="nav-btn" title="Up">
                        <i class="icon icon-arrow-up"></i>
                    </button>
                </div>

                <!-- Address Bar Container -->
                <div class="address-bar-container">
                    <div class="address-bar" id="addressBar">
                        <!-- Breadcrumb Navigation -->
                        <div class="breadcrumb-navigation" id="breadcrumbNav">
                            <button class="breadcrumb-item" data-path="C:">
                                <i class="icon icon-computer"></i>
                                <span>This PC</span>
                            </button>
                            <i class="icon icon-chevron-right breadcrumb-separator"></i>
                            <button class="breadcrumb-item" data-path="C:\VF">
                                <i class="icon icon-drive"></i>
                                <span>VF (C:)</span>
                            </button>
                            <i class="icon icon-chevron-right breadcrumb-separator"></i>
                            <button class="breadcrumb-item active" data-path="C:\VF\TeleDrive">
                                <i class="icon icon-folder"></i>
                                <span>TeleDrive</span>
                            </button>
                        </div>
                        <!-- Editable Address Input -->
                        <input type="text" id="addressInput" class="address-input" style="display: none;" placeholder="Type a path">
                    </div>
                    <button class="address-dropdown-btn" id="addressDropdownBtn" title="Recent locations">
                        <i class="icon icon-chevron-down"></i>
                    </button>
                </div>

                <!-- Search Box -->
                <div class="search-container">
                    <div class="search-box">
                        <i class="icon icon-search"></i>
                        <input type="text" id="searchInput" placeholder="Search TeleDrive">
                        <button id="clearSearch" class="clear-search-btn" style="display: none;">
                            <i class="icon icon-times"></i>
                        </button>
                    </div>
                </div>
            </div>



            <!-- Content Area -->
            <div class="content-area">
                <!-- Welcome Screen -->
                <div class="welcome-screen" id="welcomeScreen">
                    <div class="welcome-content">
                        <i class="icon icon-cloud welcome-icon"></i>
                        <h2>Chào mừng đến với TeleDrive</h2>
                        <p>Chọn một scan session từ sidebar để xem các file đã quét được</p>
                    </div>
                </div>

                <!-- Files Container -->
                <div class="files-container" id="filesContainer" style="display: none;">
                    <!-- List View Header (only visible in list/details view) -->
                    <div class="list-header" id="listHeader" style="display: none;">
                        <div class="header-cell name-header" data-sort="name">
                            <span>Tên</span>
                            <i class="icon icon-sort sort-indicator"></i>
                        </div>
                        <div class="header-cell date-header" data-sort="modified">
                            <span>Ngày sửa đổi</span>
                            <i class="icon icon-sort sort-indicator"></i>
                        </div>
                        <div class="header-cell type-header" data-sort="type">
                            <span>Loại</span>
                            <i class="icon icon-sort sort-indicator"></i>
                        </div>
                        <div class="header-cell size-header" data-sort="size">
                            <span>Kích cỡ</span>
                            <i class="icon icon-sort sort-indicator"></i>
                        </div>
                    </div>

                    <!-- Files Display Area -->
                    <div class="files-display" id="filesDisplay">
                        <!-- Files will be loaded here -->
                    </div>

                    <!-- Pagination -->
                    <div class="pagination" id="pagination" style="display: none;">
                        <button id="prevPage" class="page-btn">
                            <i class="icon icon-chevron-left"></i>
                        </button>
                        <span id="pageInfo">Trang 1 / 1</span>
                        <button id="nextPage" class="page-btn">
                            <i class="icon icon-chevron-right"></i>
                        </button>
                    </div>
                </div>

                <!-- Loading -->
                <div class="loading-screen" id="loadingScreen" style="display: none;">
                    <div class="loading">
                        <i class="fas fa-spinner fa-spin"></i>
                        <span>Đang tải file...</span>
                    </div>
                </div>

                <!-- No Results -->
                <div class="no-results" id="noResults" style="display: none;">
                    <i class="fas fa-search"></i>
                    <h3>Không tìm thấy file nào</h3>
                    <p>Thử thay đổi từ khóa tìm kiếm hoặc bộ lọc</p>
                </div>
            </div>
        </main>

        <!-- Windows Explorer Style Details Pane -->
        <aside class="details-pane" id="detailsPane" style="display: none;">
            <div class="details-header">
                <h3>Details</h3>
                <button class="details-close" id="detailsPaneClose" title="Close details pane">
                    <i class="icon icon-times"></i>
                </button>
            </div>

            <div class="details-content" id="detailsContent">
                <div class="no-selection">
                    <i class="icon icon-info"></i>
                    <p>Select an item to view its details</p>
                </div>
            </div>
        </aside>
    </div>

    <!-- File Detail Modal -->
    <div class="modal" id="fileModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Chi tiết file</h3>
                <button class="modal-close" id="modalClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body" id="modalBody">
                <!-- File details will be loaded here -->
            </div>
            
            <div class="modal-footer">
                <button class="btn btn-secondary" id="modalCloseBtn">Đóng</button>
                <button class="btn btn-primary" id="downloadBtn">
                    <i class="fas fa-download"></i>
                    Tải xuống
                </button>
            </div>
        </div>
    </div>

    <!-- File Preview Modal -->
    <div id="previewModal" class="modal preview-modal">
        <div class="modal-content preview-content">
            <div class="modal-header">
                <h3 id="previewTitle">Xem trước file</h3>
                <div class="preview-actions">
                    <button id="previewDownloadBtn" class="btn btn-primary">
                        <i class="fas fa-download"></i>
                        Tải xuống
                    </button>
                    <button class="modal-close" id="previewClose">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <div class="modal-body preview-body">
                <div id="previewContent" class="preview-content-area">
                    <!-- Preview content will be populated by JavaScript -->
                </div>
                <div id="previewInfo" class="preview-info">
                    <!-- File info will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Windows Explorer Style Status Bar -->
    <div class="explorer-status-bar">
        <div class="status-left">
            <span id="itemCount">0 items</span>
            <span id="selectedCount" style="display: none;"> • 0 items selected</span>
        </div>
        <div class="status-center">
            <div class="status-progress" id="statusProgress" style="display: none;">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <span class="progress-text" id="progressText">Loading...</span>
            </div>
        </div>
        <div class="status-right">
            <div class="view-controls">
                <button class="view-control-btn" id="zoomOutBtn" title="Zoom out">
                    <i class="icon icon-minus"></i>
                </button>
                <div class="zoom-slider-container">
                    <input type="range" class="zoom-slider" id="zoomSlider" min="0" max="4" value="2" step="1">
                </div>
                <button class="view-control-btn" id="zoomInBtn" title="Zoom in">
                    <i class="icon icon-plus"></i>
                </button>
                <div class="view-mode-controls">
                    <button class="view-mode-btn active" data-view="icons" title="Large icons">
                        <i class="icon icon-view-grid"></i>
                    </button>
                    <button class="view-mode-btn" data-view="list" title="List">
                        <i class="icon icon-view-list"></i>
                    </button>
                    <button class="view-mode-btn" data-view="details" title="Details">
                        <i class="icon icon-view-details"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile Menu Overlay -->
    <div class="mobile-overlay" id="mobileOverlay"></div>

    <!-- Scripts -->
    <script src="/static/js/simple.js?v=20250719"></script>
    <script src="/static/js/explorer.js?v=20250719"></script>
    <script src="/static/js/windows-explorer.js?v=20250720"></script>
</body>
</html>
